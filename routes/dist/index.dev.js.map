{"version":3,"sources":["index.js"],"names":["express","require","passport","router","Router","Account","get","req","res","render","title","user","post","findOne","username","body","err","message","account","newAccount","register","password","console","log","redirect","authenticate","session","returnTo","logout","next","status","send","module","exports"],"mappings":"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","sourcesContent":["var express = require('express');\r\nvar passport = require('passport');\r\nvar router = express.Router();\r\nvar Account = require('../models/account');\r\nrouter.get('/', function (req, res) {\r\n  res.render('index', { title: 'Employee App', user: req.user });\r\n});\r\nrouter.get('/register', function (req, res) {\r\n  res.render('register', { title: 'Employee App Registration' });\r\n});\r\nrouter.post('/register', function (req, res) {\r\n  Account.findOne({ username: req.body.username },\r\n    function (err, user) {\r\n      if (err) {\r\n        return res.render('register', {\r\n          title: 'Registration',\r\n          message: 'Registration error', account: req.body.username\r\n        })\r\n      }\r\n      if (user == {}) {\r\n        return res.render('register', {\r\n          title: 'Registration',\r\n          message: 'Existing User', account: req.body.username\r\n        })\r\n      }\r\n      let newAccount = new Account({ username: req.body.username });\r\n      Account.register(newAccount, req.body.password, function (err, user) {\r\n        if (err) {\r\n          return res.render('register', {\r\n            title: 'Registration',\r\n            message: 'access error', account: req.body.username\r\n          })\r\n        }\r\n        if (!user) {\r\n          return res.render('register', {\r\n            title: 'Registration',\r\n            message: 'access error', account: req.body.username\r\n          })\r\n        }\r\n        console.log('Sucess, redirect');\r\n        res.redirect('/');\r\n      })\r\n    })\r\n})\r\nrouter.get('/login', function (req, res) {\r\n  res.render('login', { title: 'Employee App Login', user: req.user });\r\n});\r\nrouter.post('/login', passport.authenticate('local'), function (req, res) {\r\n  if(req.session.returnTo) \r\n  res.redirect(req.session.returnTo); \r\nres.redirect('/'); \r\n});\r\nrouter.get('/logout', function (req, res) {\r\n  req.logout( function(err) {\r\n\r\n    if (err) { \r\n      return next(err);\r\n    }\r\n\r\n    res.redirect('/');\r\n\r\n});\r\n});\r\nrouter.get('/ping', function (req, res) {\r\n  res.status(200).send(\"pong!\");\r\n});\r\nmodule.exports = router;"],"file":"index.dev.js"}